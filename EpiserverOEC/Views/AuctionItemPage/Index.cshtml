@using OEC_webb.Models;

@model EpiserverOEC.Models.Pages.AuctionItemPage

<div class="body-content">
    <div class="container" style="margin-top:60px; padding:50px 0 30px 0">
        <div class="item col-md-6 col-sm-9 col-xs-18">

            @if (Model.Heading != null)
            {
                <h1>
                    @Html.PropertyFor(x => x.Heading)
                </h1>
            }

            @if (Model.Image != null)
            {
                <div>
                    <img src="@Url.ContentUrl(Model.Image)" style="width:100%; min-height:400px" />
                </div>
            }

            @if (Model.BodyText != null)
            {
                <p>
                    @Html.PropertyFor(x => x.BodyText)
                </p>
            }

        </div>
        <div class="item col-md-6 col-sm-9 col-xs-18" style="margin-top: 60px">

            @{
                int bid = 0;
                int lowestBid = 0;
                string bidString = "Startbud";

                int id = Convert.ToInt32(Model.PageLink.ToString());
                BidHistory bidHistory = SQLQuery.GetBidHistory(id);

                if (bidHistory.HighestBid < Model.StartingBid)
                {
                    bid = Model.StartingBid;
                }
                else
                {
                    bid = bidHistory.HighestBid;
                    lowestBid = Convert.ToInt32(Math.Ceiling(bid * 1.03));
                    bidString = "Senaste bud";
                }
            }

            <h3 style="color:firebrick">
                @bidString: @bid kr
            </h3>

            @if (bidHistory.NumberOfBids > 0)
            {
                <p>
                    Antal bud: <strong>@bidHistory.NumberOfBids</strong> · Senaste budgivare: <strong>@bidHistory.LatestBidder</strong>
                </p>
            }

            <div style="background-color:white; border: 1px solid black; padding:10px">
                <h4>Namn: <input type="text" /></h4>
                <h4>Bud: <input type="number" min = @lowestBid Value = @lowestBid max = 10000 /> kr <input type="button" value="LÄGG BUD" class="btn" style="border-radius:0; background-color:orangered; color:white" /></h4>
            </div>

            <h4><a class="row" href="~/en/auction/" style="color:firebrick">Till alla auktioner</a></h4>
        </div>
    </div>
</div>
