@using OEC_webb.Models;

@model EpiserverOEC.Models.Pages.AuctionItemPage

<div class="body-content">
    <div class="container" style="margin-top:60px; padding:50px 0 30px 0">
        <div class="item col-md-6 col-sm-9 col-xs-18">

            @if (Model.Heading != null)
            {
                <h1>
                    @Html.PropertyFor(x => x.Heading)
                </h1>
            }

            @if (Model.Image != null)
            {
                <div>
                    <img src="@Url.ContentUrl(Model.Image)" style="width:100%; min-height:400px" />
                </div>
            }

            @if (Model.BodyText != null)
            {
                <p>
                    @Html.PropertyFor(x => x.BodyText)
                </p>
            }

        </div>
        <div class="item col-md-6 col-sm-9 col-xs-18" style="margin-top: 60px">

            @{
                int bid = 0;
                int lowestBid = 0;
                int maxBid = 0;
                string bidString = "Startbud";

                string idStr = Model.PageLink.ToString();
                int id = Convert.ToInt32(idStr);
                BidHistory bidHistory = SQLQuery.GetBidHistory(id);

                if (bidHistory.HighestBid < Model.StartingBid)
                {
                    bid = Model.StartingBid;
                    lowestBid = bid;
                }
                else
                {
                    bid = bidHistory.HighestBid;
                    lowestBid = Convert.ToInt32(Math.Ceiling(bid * 1.03));
                    bidString = "Senaste bud";
                }

                maxBid = 10 * lowestBid;
            }

            <h3 style="color:firebrick">
                @bidString: @bid kr
            </h3>

            @if (bidHistory.NumberOfBids > 0)
            {
                <p>
                    Antal bud: <strong>@bidHistory.NumberOfBids</strong> · Senaste budgivare: <strong>@bidHistory.LatestBidder</strong>
                </p>
            }

            @using (Html.BeginForm("PostBid", "AuctionItemPage", FormMethod.Post))
            {
                @Html.PropertyFor(p => p.MainContentArea)
            }

            <h4><a class="row" href="~/en/auction/" style="color:firebrick">Till alla auktioner</a></h4>
        </div>
    </div>
</div>

<div style="height:60px; background-color:black; padding:15px 0 0 20%">
    <h5>
        <a href="~/en/Hem" style="color:white">Hem</a>
        <a href="~/en/auction" style="color:white">> Auktionen</a>
        <span style="color:lightgray">> @Model.Heading</span>
    </h5>
</div>

<div style="height:1px; background-color:darkgray"></div>

